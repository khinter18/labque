<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Lab Queue Control</title>

<style>
/* (YOUR DESIGN – unchanged) */

:root{
    --bg1:#f4f8fb;
    --bg2:#e9f2f7;
    --card:#ffffffee;
    --accent:#5aa6c8;
    --accent-soft:#cfe7f3;
    --text:#1f2d3d;
}

*{ box-sizing:border-box; }

body{
    margin:0;
    min-height:100vh;
    font-family:"Segoe UI", Arial, sans-serif;
    background:linear-gradient(180deg,var(--bg1),var(--bg2));
    color:var(--text);
    padding:40px;
    display:flex;
    flex-direction:column;
    align-items:center;
}

h1{
    font-size:38px;
    letter-spacing:2px;
    margin-bottom:35px;
}

.laneButtons{
    display:flex;
    gap:40px;
    flex-wrap:wrap;
    justify-content:center;
}

.laneGroup{
    display:flex;
    flex-direction:column;
    gap:18px;
}

.controlBtn{
    width:260px;
    height:80px;
    font-size:22px;
    font-weight:600;
    border:none;
    border-radius:16px;
    cursor:pointer;
    transition:all .2s ease;
    letter-spacing:.5px;
}

/* REGULAR */

.regularBtn{
    background:linear-gradient(180deg,#d9f0f7,#9fd4e6);
    color:#12485f;
    box-shadow:0 10px 25px rgba(0,0,0,.15);
}

.regularBtn:hover{
    transform:translateY(-3px) scale(1.03);
    background:linear-gradient(180deg,#e9f7fb,#b6e1ee);
}

/* EXPRESS */

.expressBtn{
    background:linear-gradient(180deg,#ffe1b8,#f7a23a);
    color:#6a3a00;
    box-shadow:0 10px 25px rgba(0,0,0,.15);
}

.expressBtn:hover{
    transform:translateY(-3px) scale(1.03);
    background:linear-gradient(180deg,#fff0d5,#ffb85c);
}

/* BIG RESET */

#resetBtn{
    margin-top:45px;
    width:420px;
    height:95px;
    font-size:30px;
    font-weight:700;
    letter-spacing:2px;
    border:none;
    border-radius:20px;
    cursor:pointer;
    background:linear-gradient(180deg,#ff7a7a,#e53935);
    color:#fff;
    box-shadow:0 15px 35px rgba(229,57,53,.45);
    transition:all .2s ease;
}

#resetBtn:hover{
    transform:translateY(-4px) scale(1.05);
    background:linear-gradient(180deg,#ff9a9a,#ff4a4a);
}

.status{
    margin-top:35px;
    font-size:26px;
    text-align:center;
}

@media(max-width:768px){
    .controlBtn{
        width:200px;
        height:65px;
        font-size:18px;
    }

    #resetBtn{
        width:90%;
        height:80px;
        font-size:24px;
    }
}
.status{
    padding: 20px;
    background-color: #a8e3ff;
    border-radius: 10px;
    font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
    text-transform: uppercase;
}
</style>
</head>

<body>

<h1>LAB QUEUE CONTROL PANEL</h1>

<div class="laneButtons">

    <div class="laneGroup">
        <button class="controlBtn regularBtn" onclick="prevRegular()">⬅ Previous Regular</button>
        <button class="controlBtn regularBtn" onclick="nextRegular()">➡ Next Regular</button>
    </div>

    <div class="laneGroup">
        <button class="controlBtn expressBtn" onclick="prevExpress()">⬅ Previous Express</button>
        <button class="controlBtn expressBtn" onclick="nextExpress()">➡ Next Express</button>
    </div>

</div>

<button id="resetBtn" onclick="resetQueue()">RESET QUEUE</button>

<div class="status">
    <p>Regular Lane : <span id="regStatus">R-000</span></p>
    <p>Express Lane : <span id="expStatus">E-000</span></p>
</div>

<script>
/* -------------------------------
   SHARED COUNTERS
-------------------------------- */

let regCounter = parseInt(localStorage.getItem("regCounter")) || 0;
let expCounter = parseInt(localStorage.getItem("expCounter")) || 0;


/* -------------------------------
   AUDIO CONTROL (GLOBAL)
-------------------------------- */

let currentBell = null;
let speakDelayTimer = null;

function stopAllAudio(){

    speechSynthesis.cancel();

    if(currentBell){
        currentBell.pause();
        currentBell.currentTime = 0;
        currentBell = null;
    }

    if(speakDelayTimer){
        clearTimeout(speakDelayTimer);
        speakDelayTimer = null;
    }
}


/* -------------------------------
   DISPLAY
-------------------------------- */

function updateDisplay(){

    document.getElementById("regStatus").textContent =
        "R-" + String(regCounter).padStart(3,"0");

    document.getElementById("expStatus").textContent =
        "E-" + String(expCounter).padStart(3,"0");

    localStorage.setItem("regCounter", regCounter);
    localStorage.setItem("expCounter", expCounter);
}


/* -------------------------------
   QUEUE BUTTONS
-------------------------------- */

function nextRegular(){
    stopAllAudio();
    regCounter++;
    updateDisplay();
    playBell("R-" + String(regCounter).padStart(3,"0"));
}

function prevRegular(){
    stopAllAudio();
    if(regCounter > 0){
        regCounter--;
        updateDisplay();
        playBell("R-" + String(regCounter).padStart(3,"0"));
    }
}

function nextExpress(){
    stopAllAudio();
    expCounter++;
    updateDisplay();
    playBell("E-" + String(expCounter).padStart(3,"0"));
}

function prevExpress(){
    stopAllAudio();
    if(expCounter > 0){
        expCounter--;
        updateDisplay();
        playBell("E-" + String(expCounter).padStart(3,"0"));
    }
}


/* -------------------------------
   RESET
-------------------------------- */

function resetQueue(){

    stopAllAudio();

    if(!confirm("Are you sure you want to reset the queue?")) return;

    regCounter = 0;
    expCounter = 0;

    updateDisplay();

    currentBell = new Audio("bell2.wav");
    currentBell.volume = 0.5;
    currentBell.play();
}


/* -------------------------------
   BELL + VOICE
-------------------------------- */

function playBell(number){

    stopAllAudio();

    currentBell = new Audio("bell2.wav");
    currentBell.volume = 0.5;
    currentBell.play();

    currentBell.onended = function(){

        speakDelayTimer = setTimeout(function(){

            const voices = speechSynthesis.getVoices();

            let femaleVoice =
                voices.find(v =>
                    /female|zira|samantha|alloy/i.test(v.name)
                ) || voices[0];

            for(let i=0;i<2;i++){

                const msg = new SpeechSynthesisUtterance(
                    "patient number " +
                    number.replace("-", " ") +
                    ", please proceed to the extraction area."
                );

                msg.voice = femaleVoice;
                msg.rate = 1;

                speechSynthesis.speak(msg);
            }

        },100);   // delay before speaking
    };
}


/* -------------------------------
   KEYBOARD SHORTCUTS
-------------------------------- */

document.addEventListener("keydown", function(e){

    if(["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(e.key)){
        e.preventDefault();
        stopAllAudio();
    }

    switch(e.key){

        case "ArrowUp":      // EXPRESS NEXT
            nextExpress();
            break;

        case "ArrowRight":  // REGULAR NEXT
            nextRegular();
            break;

        case "ArrowDown":   // EXPRESS PREVIOUS
            prevExpress();
            break;

        case "ArrowLeft":   // REGULAR PREVIOUS
            prevRegular();
            break;
    }
});


/* -------------------------------
   INIT
-------------------------------- */

updateDisplay();

window.speechSynthesis.onvoiceschanged = function(){
    speechSynthesis.getVoices();
};
</script>

</body>
</html>
